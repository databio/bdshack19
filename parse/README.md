# Parse Modules

In this module, we parse multi-omics raw data from [GSE117089](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE117089) (i.e. the [sciCAR paper](http://science.sciencemag.org/content/361/6409/1380)) into a Python data object.

## Input

We take as inputs a set of text files downloaded from GEO and create an [AnnData](https://anndata.readthedocs.io/en/latest/) object for use in downstream analysis with Python. We use class [anndata.AnnData](https://anndata.readthedocs.io/en/latest/anndata.AnnData.html#anndata.AnnData) in order to exploit the many functions useful for analyzing single-cell expression data introduced by the [Theis Lab](https://github.com/theislab) in [Scanpy](https://scanpy.readthedocs.io/en/stable/).

## Output

We offer an option to output a [pickled](https://docs.python.org/3/library/pickle.html#module-pickle) data object written to a file for later use, although the higher value outputs are generated by downstream modules.

## Overview

For each data type (e.g. RNA, ATAC), we create a single AnnData object. We then load the individual AnnData objects into a custom object of class [Multimeasure](../master/mixsc/multimeasure.py) that contains all data types (e.g. levels of omics data) generated from a set of samples. Within the Multimeasure object, observations of one modality for a given set of samples can be linked to observations of a different modality for the same samples. This permits seamless integration of multiple omics modalities in downstream analyses.

## Details

We use the [SciPy library](https://www.scipy.org/scipylib/index.html) to read a Matrix Market file-like count matrix into a sparse matrix. We read counts with `scipy.io.mmread(source)`.

We use the [pandas library](http://pandas.pydata.org/) to read annotation matrices into dataframes. We read annotations with `pandas.read_csv(source)`.

As noted above, we use the [anndata class](https://anndata.readthedocs.io/en/latest/anndata.AnnData.html#anndata.AnnData) to store annotations for variables (columns) and observations (rows) with their associated matrix of measurements. We associate dataframes and matrix with `AnnData(X=X, obs=obs, var=var)`.

Finally, we use [pandas](http://pandas.pydata.org/) once more to link annotations and measurements for samples across multiple modalities. We link across modalities with `pd.merge(mod1, mod2, how=how, on=on)`.
